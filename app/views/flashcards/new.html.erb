<%= content_for(:extra_javascripts) do %>
    <%= javascript_include_tag '//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js'  %>
    <%= javascript_include_tag '//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.20/angular-sanitize.min.js'  %>
    <%= javascript_include_tag 'angular-redactor' %>
<% end %>

<div ng-app="FlashcardApp" ng-controller="FlashcardController">
  <div class="inner flashcard_create_page_inner">
    <div class="sub_heading_wrapper flashcard_create_heading">
      <h1>Your new Flashcard</h1>
    </div>
    <div class="sub_heading_right_flashcard_create_heading">
      <a href="javascript:;" class="podmedcis_button green flash_cards_button">Preview a sample</a>
      <a href="javascript:;" class="podmedcis_button green flash_cards_button preview">Preview your flashcard</a>
    </div>

    <div class="page flashcard_create">
      <div class="flashcard_create_header">
        Create your flashcard by filling in this nifty form. You can preview it live on the right of this page. For every flashcard that you submit, and is accepted, you will get two free months of Podmedics membership (and eternal fame!)

        <p>Don't worry if the video covers lots of conditions, just <strong>choose one for your flashcard</strong></p
      </div>

      <div class="flashcard_create_left_column">
        <%= simple_form_for [@video, @flashcard] do |f| %>
            <%= f.error_notification %>
            <div class="flashcard_create_left_column_inner_spacing">
              <h2>General</h2>
              <%= f.input :epidemiology, as: :text, label: 'Definition and Basic Epidemiology', hint: 'Define the condition in a single sentence and add some basic epidemiology', input_html: { :'ng-model' => 'flashcard.epidemiology', :'redactor' => '' } %>
              <%= f.input :pathology, as: :text, label: 'Pathology', hint: 'Describe the basic pathology', input_html: { :'ng-model' => 'flashcard.pathology', :'redactor' => '' } %>
              <%= f.input :causes, as: :text, label: 'Top three causes', hint: 'Top three causes only please! We do not like long lists...', input_html: { :'ng-model' => 'flashcard.causes', :'redactor' => '' } %>
            </div>
            <div class="flashcard_create_left_column_inner_spacing">
              <h2>Clinical Features</h2>
              <%= f.input :symptoms, as: :text, label: 'Symptoms', hint: 'How does the patient present? Divide up into general and specific for extra points!', input_html: { :'ng-model' => 'flashcard.symptoms', :'redactor' => '' } %>
              <%= f.input :signs, as: :text, label: 'Signs (general and specific)', hint: 'What will you find on examination?', input_html: { :'ng-model' => 'flashcard.signs', :'redactor' => '' } %>
            </div>
            <div class="flashcard_create_left_column_inner_spacing">
              <h2>Investigations</h2>
              <%= f.input :inv_cultures, as: :text, label: 'Dips/Cultures', hint: 'e.g. urine dips, any microscopy or cultures', input_html: { :'ng-model' => 'flashcard.inv_cultures', :'redactor' => '' } %>
              <%= f.input :inv_bloods, as: :text, label: 'Bloods (arterial/venous)', hint: 'Try and put the reason for the test in brackets after it', input_html: { :'ng-model' => 'flashcard.inv_bloods', :'redactor' => '' } %>
              <%= f.input :inv_imaging, as: :text, label: 'Imaging', hint: 'Try and put the reason for the test in brackets after it', input_html: { :'ng-model' => 'flashcard.inv_imaging', :'redactor' => '' } %>
              <%= f.input :inv_scopic, as: :text, label: 'Scopic/Biopsy', hint: 'e.g. bronchoscopy, colonoscopy, any biopsy', input_html: { :'ng-model' => 'flashcard.inv_scopic', :'redactor' => '' } %>
              <%= f.input :inv_functional, as: :text, label: 'Functional/Special Tests', hint: 'Special tests for this specialty e.g. ECG (cardiology), spirometry (respiratory)', input_html: { :'ng-model' => 'flashcard.inv_functional', :'redactor' => '' } %>
            </div>
            <div class="flashcard_create_left_column_inner_spacing">
              <h2>Treatment</h2>
              <%= f.input :treat_cons, as: :text, label: 'Conservative', hint: 'e.g. fluids, pain relief, NBM', input_html: { :'ng-model' => 'flashcard.treat_cons', :'redactor' => '' } %>
              <%= f.input :treat_medical, as: :text, label: 'Medical', hint: 'Drugs used to treat the condition', input_html: { :'ng-model' => 'flashcard.treat_medical', :'redactor' => '' } %>
              <%= f.input :treat_surgical, as: :text, label: 'Surgical', hint: 'Surgery used to treat the condition', input_html: { :'ng-model' => 'flashcard.treat_surgical', :'redactor' => '' } %>
              <button class="podmedcis_button green" type="submit">Submit flashcard</button>
            </div>
        <% end %>
      </div>

    </div>

  </div>



  <!-- This is the live update flash card -->

  <div class="flashcard_wrapper live_update">
    <div class="close_flashcard_wrapper live_update_spacing preview_flashcard_close">
      <div class="close_flashcard"></div>
    </div>


    <div class="inner_flashcard_wrapper">
      <div class="flashcard_name">
        <%= @video.title %>
      </div>

      <div class="flashcard_user_created_name">
        Created by <a href="#"><%= current_user.name %></a>
      </div>

      <div class="flashcard_divider"></div>

      <div class="flashcard_title">General</div>

      <div class="flashcard_title sub">Epidemiology</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.epidemiology">
      </div>

      <div class="flashcard_title sub">Pathology</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.pathology">
      </div>

      <div class="flashcard_title sub">Top three causes</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.causes">
      </div>

      <div class="flashcard_divider"></div>

      <div class="flashcard_title">Clinical Features</div>

      <div class="flashcard_title sub">Symptoms (general and specific)</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.symptoms">
      </div>

      <div class="flashcard_title sub">Signs (general and specific)</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.signs">
      </div>

      <div class="flashcard_divider"></div>

      <div class="flashcard_title">Investigations</div>
      <div class="flashcard_table_wrapper">
        <table>
          <tbody><tr>
            <td class="flashcard_table_left_column">Cultures</td>
            <td ng-bind-html="flashcard.inv_cultures"></td>
          </tr>
          <tr>
            <td class="flashcard_table_left_column">Bloods</td>
            <td ng-bind-html="flashcard.inv_bloods"></td>
          </tr>
          <tr>
            <td class="flashcard_table_left_column">Imaging</td>
            <td ng-bind-html="flashcard.inv_imaging"></td>
          </tr>
          <tr>
            <td class="flashcard_table_left_column">Scopic/Biopsy</td>
            <td ng-bind-html="flashcard.inv_scopic"></td>
          </tr>
          <tr>
            <td class="flashcard_table_left_column">Functional</td>
            <td ng-bind-html="flashcard.inv_functional"></td>
          </tr>
          </tbody></table>

      </div>
      <div class="flashcard_divider"></div>

      <div class="flashcard_title">Treatment</div>


      <div class="flashcard_title sub">Conservative</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.treat_cons">
      </div>

      <div class="flashcard_title sub">Medical</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.treat_medical">
      </div>

      <div class="flashcard_title sub">Surgical</div>
      <div class="flashcard_copy" ng-bind-html="flashcard.treat_surgical">
      </div>

    </div>
  </div>
</div>
<!--   End live update flash card-->

<!-- This is an example flashcard -->
<%= render 'flashcards/example_flashcard' %>

<!-- Angular bindings -->
<script type="text/javascript">
    (function(){
        angular.module('FlashcardApp', ['ngSanitize', 'angular-redactor'])
                .config(function(redactorOptions){
                    redactorOptions.buttons = ['bold', 'italic', '|', 'unorderedlist', 'orderedlist'];
                });

        angular.module('FlashcardApp').controller('FlashcardController', FlashcardController);

        function FlashcardController($scope){
            $scope.flashcard = {};
            $scope.flashcard.epidemiology = 'None';
            $scope.flashcard.pathology = 'None';
            $scope.flashcard.causes = 'None';
            $scope.flashcard.symptoms = 'None';
            $scope.flashcard.signs = 'None';
            $scope.flashcard.inv_cultures = 'None';
            $scope.flashcard.inv_bloods = 'None';
            $scope.flashcard.inv_imaging = 'None';
            $scope.flashcard.inv_scopic = 'None';
            $scope.flashcard.inv_functional = 'None';
            $scope.flashcard.treat_cons = 'None';
            $scope.flashcard.treat_medical = 'None';
            $scope.flashcard.treat_surgical = 'None';
        }
    })();
</script>