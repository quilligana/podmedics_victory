<script>
function getUserProgress()
{
  var stats = [];

  <% (0..DASHBOARD_CHART_DAYS).each do |daysAgo| %>
  stats[<%= daysAgo %>] = { value: <%= current_user.daily_stat(daysAgo) %>, date: getDate(<%= daysAgo %>) }
  <% end %>

  console.log(stats);

  return stats;
}

function getDate(daysAgo)
{
    var date = new Date();
    date.setDate(date.getDate() - daysAgo);
    return date
}

function createChart() {
    $("#chart").kendoChart({
        chartArea: {
            background:"#F0F0F0",
        },

        dataSource: {
            data: getUserProgress()
        },
        series: [{
            type: "line",
            aggregate: "avg",
            field: "value",
            categoryField: "date"
        }],
        categoryAxis: {

            baseUnit: "days"
        }
    });
}

function create_questionsChart() {
    $("#questions_chart").kendoChart({
        title: {
            text: "Your score compared to others in the community"
        },
        legend: {
            visible: false
        },
        seriesDefaults: {
            type: "bubble"
        },
        series: [{
            data: [{
                x: 2500,
                y: 50000,
                size: 500000,
                category: "Microsoft"
            }, {
                x: 500,
                y: 110000,
                size: 7600000,
                category: "Starbucks"
            }, {
                x: 7000,
                y: 19000,
                size: 700000,
                category: "Google"
            }, {
                x: 1400,
                y: 150000,
                size: 700000,
                category: "Publix Super Markets"
            }, {
                x: 2400,
                y: 30000,
                size: 300000,
                category: "PricewaterhouseCoopers"
            }, {
                x: 2450,
                y: 34000,
                size: 90000,
                category: "Cisco"
            }, {
                x: 2700,
                y: 34000,
                size: 400000,
                category: "Accenture"
            }, {
                x: 2900,
                y: 40000,
                size: 450000,
                category: "Deloitte"
            }, {
                x: 3000,
                y: 55000,
                size: 900000,
                category: "Whole Foods Market"
            }]
        }],
        xAxis: {
            labels: {
                format: "{0:N0}",
                skip: 1
            },
            axisCrossingValue: 0,
            majorUnit: 2000,
            plotBands: [{
                from: 0,
                to: 2000,
                color: "#FF414E",
                opacity: 0.05
            }]
        },
        yAxis: {
            labels: {
                format: "{0:N0}"
            },

            line: {
                width: 0
            }
        },
        tooltip: {
            visible: true,
            format: "{3}: {2:N0} points",
            opacity: 1
        }
    });
}



$(document).ready(createChart);
$(document).ready(create_questionsChart);

</script>